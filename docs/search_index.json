[
["университеты-и-их-гранты.html", "6 Университеты и их гранты", " 6 Университеты и их гранты Соединим Дашин датасет по РИНЦу и по данные по грантам универов Алексея. df &lt;- read_csv(&quot;data/joined_final_clean.csv&quot;) #colnames(df) У нас 7610 грантов за 2014-2019 годы. В РИНЦе нет 52 организаций, которые получали гранты РНФ (всего 97 гратнтов из 7610 мы далее выбросим из анализа). Что мы хотимс посмотреть: Топ организаций по грантам Топ регионов по грантам с информацией о кол-ве организваций Топ универов по Доле классных публикаций Топ регионов по доле классных публикаций 3 и 4 (для организаций &gt; 25 Скопусовских/WoS за 5 лет) Таблица 1: Топ организаций по грантам rf &lt;- df %&gt;% mutate(Uni = gsub(&#39;&quot;&#39;, &#39;&#39;, Uni)) %&gt;% group_by(id,Uni) %&gt;% count() colnames(rf)[1] &lt;- &quot;id по РИНЦ&quot; rf &lt;- formattable(rf) as.datatable(rf) Таблица 2: Топ регионов по грантам с информацией о кол-ве организваций rf &lt;- df %&gt;% group_by(Регион, id) %&gt;% summarise(grants_count = length(Регион)) %&gt;% group_by(Регион) %&gt;% summarise(uni_count = length(id), grants_count = sum(grants_count)) %&gt;% mutate(`грантов на организацию` = grants_count/uni_count) colnames(rf)[3] &lt;- &quot;всего грантов&quot; colnames(rf)[2] &lt;- &quot;всего организаций&quot; rf &lt;- formattable(rf) as.datatable(rf) Таблица 3: Топ универов по Доле классных публикаций Посчитаем долю (%) публикаций Scopus и Web of Science от общего числа публикаций в организации по такой формуле: \\[ \\frac{sco\\_wos\\_5}{elab\\_5 +1} * 100\\] где, \\(sco\\_wos\\_5\\) - число статей в журналах, входящих в Web of Science или Scopus, за 5 лет (переменная в кодбуке – N_pub_WOSSC5) \\(elab\\_5\\) - число публикаций на elibrary, за 5 лет (переменная в кодбуке – N_elibrary5) Единицу в знаменатель мы добавили, чтобы не отрезать организации, у которых 0 публикаций на elibrary.ru за 5 лет. # код для убирания процентов в скобках nl &lt;- df %&gt;% mutate(N_pub_WOSSC5_persent = gsub(&quot;[\\\\(\\\\)]&quot;, &quot;&quot;, regmatches(N_pub_WOSSC5, gregexpr(&quot;\\\\(.*?\\\\)&quot;, N_pub_WOSSC5)))) %&gt;% mutate(N_pub_WOSSC5_persent = gsub(&quot;%&quot;, &quot;&quot;, N_pub_WOSSC5_persent)) %&gt;% mutate(N_pub_WOSSC5_persent = gsub(&quot;,&quot;, &quot;.&quot;, N_pub_WOSSC5_persent)) %&gt;% mutate(N_pub_WOSSC5 = gsub(&quot;\\\\(.*&quot;,&quot;&quot;,N_pub_WOSSC5)) %&gt;% mutate(N_pub_WOSSC5 = as.numeric(N_pub_WOSSC5), N_pub_WOSSC5_persent = as.numeric(as.character(N_pub_WOSSC5_persent))) %&gt;% mutate(Uni = gsub(&#39;&quot;&#39;, &#39;&#39;, Uni)) #nl &lt;- nl %&gt;% dplyr::filter(N_pub_WOSSC5 &gt; 24) options(digits = 3) h &lt;- data.table::setDT(nl)[ , list(`доля классных публикаций` = 100*(N_pub_WOSSC5/(N_elibrary5+1)), count_of_grants = .N), by = .(Uni)] h &lt;- h %&gt;% distinct(Uni, .keep_all = TRUE) h &lt;- formattable(h) as.datatable(h) Теперь агрегируем эти данные по универам, чтобы получить данные по регионам. Таблица 4: Топ регионов по доле классных публикаций Тут мы делаем рейтинг регионов ТОЛЬКО по организациям, которые хоть раз получали грант РНФ. rg &lt;- nl %&gt;% mutate(share_good = 100*(N_pub_WOSSC5/(N_elibrary5+1))) %&gt;% group_by(Регион) %&gt;% summarise(mean = mean(share_good), median = median(share_good), min = min(share_good), max = max(share_good), `всего грантов` = length(share_good)) ra &lt;- rf %&gt;% select(1,2,4) rg &lt;- left_join(rg,ra, by = &quot;Регион&quot; ) rg &lt;- formattable(rg) as.datatable(rg) "]
]
