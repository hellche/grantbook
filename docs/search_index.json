[
["университеты-и-их-гранты.html", "5 Университеты и их гранты", " 5 Университеты и их гранты Соединим Дашин датасет по РИНЦу и данные Алексея по грантам универов. df &lt;- read_csv(&quot;data/full_11_May_version.csv&quot;) #colnames(df) У нас 7610 грантов за 2014-2019 годы. В РИНЦе нет 23 организации, которые получали гранты РНФ (всего 33 гратнта из 7610 мы далее выбросим из анализа). Что мы хотимс посмотреть: Топ организаций по грантам Топ регионов по грантам с информацией о кол-ве организваций Топ универов по Доле классных публикаций Топ регионов по доле классных публикаций 3 и 4 (для организаций &gt; 25 Скопусовских/WoS за 5 лет) Таблица 1: Топ организаций по грантам rf &lt;- df %&gt;% mutate(Univ = gsub(&#39;&quot;&#39;, &#39;&#39;, Univ)) %&gt;% group_by(id,Univ) %&gt;% count() colnames(rf)[1] &lt;- &quot;id по РИНЦ&quot; rf &lt;- formattable(rf) as.datatable(rf) Таблица 2: Топ регионов по грантам с информацией о кол-ве организваций rf &lt;- df %&gt;% group_by(Регион, id) %&gt;% summarise(grants_count = length(Регион)) %&gt;% group_by(Регион) %&gt;% summarise(uni_count = length(id), grants_count = sum(grants_count)) %&gt;% mutate(`грантов на организацию` = grants_count/uni_count) colnames(rf)[3] &lt;- &quot;всего грантов&quot; colnames(rf)[2] &lt;- &quot;всего организаций&quot; rf &lt;- formattable(rf) as.datatable(rf) Таблица 3: Топ универов по Доле классных публикаций Посчитаем долю (%) публикаций Scopus и Web of Science от общего числа публикаций в организации по такой формуле: \\[ \\frac{sco\\_wos\\_5}{elab\\_5 +1} * 100\\] где, \\(sco\\_wos\\_5\\) - число статей в журналах, входящих в Web of Science или Scopus, за 5 лет (переменная в кодбуке – N_pub_WOSSC5) \\(elab\\_5\\) - число публикаций на elibrary, за 5 лет (переменная в кодбуке – N_elibrary5) Единицу в знаменатель мы добавили, чтобы не отрезать организации, у которых 0 публикаций на elibrary.ru за 5 лет. # код для убирания процентов в скобках nl &lt;- df %&gt;% mutate(N_pub_WOSSC5_persent = gsub(&quot;[\\\\(\\\\)]&quot;, &quot;&quot;, regmatches(N_pub_WOSSC5, gregexpr(&quot;\\\\(.*?\\\\)&quot;, N_pub_WOSSC5)))) %&gt;% mutate(N_pub_WOSSC5_persent = gsub(&quot;%&quot;, &quot;&quot;, N_pub_WOSSC5_persent)) %&gt;% mutate(N_pub_WOSSC5_persent = gsub(&quot;,&quot;, &quot;.&quot;, N_pub_WOSSC5_persent)) %&gt;% mutate(N_pub_WOSSC5 = gsub(&quot;\\\\(.*&quot;,&quot;&quot;,N_pub_WOSSC5)) %&gt;% mutate(N_pub_WOSSC5 = as.numeric(N_pub_WOSSC5), N_pub_WOSSC5_persent = as.numeric(as.character(N_pub_WOSSC5_persent))) %&gt;% mutate(Univ = gsub(&#39;&quot;&#39;, &#39;&#39;, Univ)) #nl &lt;- nl %&gt;% dplyr::filter(N_pub_WOSSC5 &gt; 24) options(digits = 3) h &lt;- data.table::setDT(nl)[ , list(`доля классных публикаций` = 100*(N_pub_WOSSC5/(N_elibrary5+1)), count_of_grants = .N), by = .(Univ)] h &lt;- h %&gt;% distinct(Univ, .keep_all = TRUE) h &lt;- formattable(h) as.datatable(h) Теперь агрегируем эти данные по универам, чтобы получить данные по регионам. КАК МЫ АГРЕГИРУЕМ: агрегируем по грантам, а не по организациям. Например, в Воронежской области на 4 организации приходится 35 грантов. Причем одна организация с самым высоким показателем класнных публикаций получила большую часть из этих 35 грантов. Таким образом, самое большое значение (максимум) еще и встало на место медианы. Таблица 4: Топ регионов по доле классных публикаций Тут мы делаем рейтинг регионов ТОЛЬКО по организациям, которые хоть раз получали грант РНФ. rg &lt;- nl %&gt;% mutate(share_good = 100*(N_pub_WOSSC5/(N_elibrary5+1))) %&gt;% group_by(Регион) %&gt;% summarise(mean = mean(share_good), median = median(share_good), min = min(share_good), max = max(share_good), `всего грантов` = length(share_good)) ra &lt;- rf %&gt;% dplyr::select(1,2,4) rg &lt;- left_join(rg,ra, by = &quot;Регион&quot; ) rg &lt;- formattable(rg) as.datatable(rg) "],
["идеи-от-михаила.html", "Идеи от Михаила", " Идеи от Михаила Посмотреть как часто повторяются фамилии Кол-во гос организаций (РАН, гос вузы) vs. негосударственные (автономные): гранты как мертоновская “награда”, эффект Матфея По областям фиксируют квоты? Динамика после 5:100 1. Как часто повторяются фамилии В таблице 5 пока первое приближение. Надо контролировать на “Конкурс на продление сроков” и тезок. Первое сделать проще, второе - сложнее. Например, Иванов Д. В. это скорее всего три разных человека судя по аффилиации и области знания. Таблица 5. Число гранов у руководителей library(readxl) df2 &lt;- read_excel(&quot;data/allRSCF2020-1.xls&quot;, sheet = &quot;Лист1&quot;) df2 &lt;- df2 %&gt;% dplyr::select(1,3,4,5,6,8,9,12,17,22,23) supervisirs &lt;- df2 %&gt;% group_by(ФИО) %&gt;% dplyr::filter(!is.na(ФИО)) %&gt;% count() %&gt;% arrange(desc(n)) supervisirs &lt;- formattable(supervisirs) as.datatable(supervisirs) Оставим группировку по ФИО, но посмотрим какие научные области прячутся внутри. Добавим к таблице 5 колонку с этой инфомацией. Таблица 6. df3 &lt;- df2 %&gt;% dplyr::mutate(dummy = case_when(grepl(&quot;Конкурс на продление сроков&quot;, Конкурс) ~ 1, TRUE ~ 0)) df3 &lt;- df3 %&gt;% dplyr::mutate(area = gsub(&quot;дополнительные.*&quot;,&quot;&quot;,main_code), area = gsub(&quot;основной:&quot;,&quot;&quot;,area), area = str_trim(area, side = &quot;both&quot;), area = gsub(&quot;-.*&quot;,&quot;&quot;,area), area = if_else(area == &quot;нет&quot;, &#39;NA&#39;, area)) f &lt;- df3 %&gt;% dplyr::select(3, 13) %&gt;% dplyr::filter(!is.na(ФИО)) %&gt;% group_by(ФИО) %&gt;% arrange(area) %&gt;% summarise(area = paste(area, collapse = &quot;, &quot;)) f &lt;- left_join(f, supervisirs, by = &quot;ФИО&quot;) f &lt;- arrange(f, desc(n)) f &lt;- formattable(f) as.datatable(f) Предположительно мы сразу видем тезок в первой десятке, разобъем их. Таблица 7. autors&lt;- df3 %&gt;% dplyr::select(3, 13) %&gt;% dplyr::filter(!is.na(ФИО)) %&gt;% group_by(ФИО, area) %&gt;% count() %&gt;% arrange(desc(n)) autors &lt;- formattable(autors) as.datatable(autors) Иванов К. Л. видимо всё еще два человека, которые оба получили гранты в области 03 - Химия. Если нужно, то можно еще более детально разбить - с учетом аффилиации руководителя проекта. Но для начала проконтролируем на “Конкурс на продление сроков”, чтобы понять кто получил несколько независимых друг от друга грантов. В выборке есть 902 гранта по “Конкурсу на продление сроков”. Уберем их и у нас останется: Таблица 8. autors&lt;- df3 %&gt;% dplyr::filter(!is.na(ФИО)) %&gt;% dplyr::filter(dummy == 0) %&gt;% dplyr::select(3, 13) %&gt;% group_by(ФИО, area) %&gt;% count() %&gt;% arrange(desc(n)) autors &lt;- formattable(autors) as.datatable(autors) Таким образом, мы убрали все “продления” грантов, попытались раскидать тезок через области знания, и получили следующую картину: Таблица 9a. v &lt;- autors %&gt;% group_by(n) %&gt;% count() colnames(v)[1] &lt;- &quot;Число грантов (без продлений)&quot; colnames(v)[2] &lt;- &quot;Руклводителей грантов&quot; knitr::kable(v , booktabs = T) %&gt;% kable_styling(bootstrap_options = &quot;striped&quot;, full_width = F) Число грантов (без продлений) Руклводителей грантов 1 5275 2 714 3 1 4 1 У нас 714 руководителей получали грант дважды (это ~ 12 %). Кончечно там тоже могут прятаться тезки, которые кроме одинаковых ФИО еще имеют одинаковые научные области. Уникумы у нас видимо только Ремесленников В. Н. и один из Ивановых К. Л., которые получали гранты трижды (и это не считая продлений). Катерина предложила посмотреть чем занисаются авторы, которые плучают два гранта (из каких они областей). Уберем двоих авторов-уникумов, у которых &gt; 2 грантов. Таблица 9b. v &lt;- autors %&gt;% dplyr::filter(n &lt; 3) %&gt;% dplyr::filter(!is.na(area)) %&gt;% dplyr::filter(area != &#39;NA&#39;) %&gt;% group_by(n, area) %&gt;% count() library(tidyr) ar_ye3 &lt;- spread(v, key = n, value = nn) ar_ye3$area[ar_ye3$area == &quot;01&quot;] &lt;- &quot;01 - математика&quot; ar_ye3$area[ar_ye3$area == &quot;02&quot;] &lt;- &quot;02 - физика&quot; ar_ye3$area[ar_ye3$area == &quot;03&quot;] &lt;- &quot;03 - химия&quot; ar_ye3$area[ar_ye3$area == &quot;04&quot;] &lt;- &quot;04 - биология&quot; ar_ye3$area[ar_ye3$area == &quot;05&quot;] &lt;- &quot;05 - медицина&quot; ar_ye3$area[ar_ye3$area == &quot;06&quot;] &lt;- &quot;06 - с/х&quot; ar_ye3$area[ar_ye3$area == &quot;07&quot;] &lt;- &quot;07 - науки о земле&quot; ar_ye3$area[ar_ye3$area == &quot;08&quot;] &lt;- &quot;08 - гум и соц&quot; ar_ye3$area[ar_ye3$area == &quot;09&quot;] &lt;- &quot;09 - инженерия&quot; colnames(ar_ye3)[2] &lt;- &quot;1 грант&quot; colnames(ar_ye3)[3] &lt;- &quot;2 гранта&quot; ar_ye3 &lt;- ar_ye3 %&gt;% mutate(sd_1 = 100*`1 грант`/(`1 грант`+`2 гранта`), sd_2 = 100*`2 гранта`/(`1 грант`+`2 гранта`)) colnames(ar_ye3)[2] &lt;- &quot;1 грант (чел)&quot; colnames(ar_ye3)[3] &lt;- &quot;2 гранта (чел)&quot; colnames(ar_ye3)[4] &lt;- &quot;1 грант (%)&quot; colnames(ar_ye3)[5] &lt;- &quot;2 гранта (%)&quot; knitr::kable(ar_ye3 , booktabs = T) %&gt;% kable_styling(bootstrap_options = &quot;striped&quot;, full_width = F) %&gt;% add_header_above(c(&quot; &quot; = 1, &quot;Авторов, получивших&quot; = 2, &quot;Авторов, получивших&quot; = 2)) Авторов, получивших Авторов, получивших area 1 грант (чел) 2 гранта (чел) 1 грант (%) 2 гранта (%) 01 - математика 468 54 89.7 10.35 02 - физика 755 97 88.6 11.38 03 - химия 853 133 86.5 13.49 04 - биология 594 127 82.4 17.61 05 - медицина 531 90 85.5 14.49 06 - с/х 173 10 94.5 5.46 07 - науки о земле 397 52 88.4 11.58 08 - гум и соц 526 46 92.0 8.04 09 - инженерия 962 105 90.2 9.84 Среди биологов ~ 18 % руководителей проектов получили два гранта (без учета продлений). В с/х науках только 5 % авторов получили два гранта. 2. Гос организаций vs. негос Вернулись к выборке из 7577 грантов (у которых нашлась организация в РИНЦе). Сделаем дамми для гос организаций (помимо всяких федеральных бла-бла, бюджетных бла-бла, мы туда добавили акционерные общества при гос учреждениях, например, Акционерное общество Государственный оптический институт или Акционерное общество Государственный научно-исследовательский и проектный институт редкометаллической промышленности). Вот что получилось (не забудь поправить NA – засунуть в гос организации, это ИНСТИТУТ МОНГОЛОВЕДЕНИЯ, БУДДОЛОГИИ И ТИБЕТОЛОГИИ СО РАН Улан-Удэ). Таблица 10. #for_save2 &lt;- df %&gt;% group_by(Univers) %&gt;% count() #write.csv(for_save2, &quot;for_save2.csv&quot;, fileEncoding = &quot;UTF-8&quot;) library(readr) for_save2 &lt;- read_delim(&quot;data/for_save2.csv&quot;, &quot;;&quot;, escape_double = FALSE, trim_ws = TRUE) for_save2 &lt;- for_save2 %&gt;% dplyr::select(2,4) data &lt;- left_join(df, for_save2, by = &quot;Univers&quot;) data1 &lt;- data %&gt;% dplyr::select(2,3,4,6,7,9,613) J &lt;- data1 %&gt;% group_by(gov) %&gt;% count() knitr::kable(J, booktabs = T) %&gt;% kable_styling(bootstrap_options = &quot;striped&quot;, full_width = F) gov n 0 162 1 7413 NA 2 Из всех 7577 грантов, только 162 (~2 %) ушло негосударственным организациям. Посмотрим кто у нас получил эти 162 гранта и что за негосударственные организации там прячутся. Таблица 11 a. g &lt;- data1 %&gt;% dplyr::filter(gov ==0) %&gt;% group_by(Univ) %&gt;% count() g &lt;- formattable(g) g &lt;- g %&gt;% arrange(desc(n)) as.datatable(g) Всего 162 гратна распределились между 27 негосударственнми организациями. Возможно я тут зря кого-то из них не отнесла к государтвеннми, но если что, поправлю. Я если честно не знаю какой вывод тут деалть, много это или мало, что только 2 % грантов уходит негосударственным организациям. Если бы у нас тут были только вузы, мы бы посмотрели генеральную совокупность всех вузов в России, обнаружили, что из, допустим, 1500 вузов россии 90 % - государственные + их филиалы, а 10 % негосудартственные. Тогда бы мы сказали, смотрите, негосударственных вузов 10 %, а грантов они получают только 2%. Но мы так не можем сделать, так как львиная доля всех грантов у нас уходит во всевозможные подразделения РАН. Попробуем оставить только вузы. Возьмем мониторинг вузов: 822 вуза, частные + гос, без филиалов (файл от Анжелики). library(readxl) f1 &lt;- read_excel(&quot;data/universities_rince_id.xlsx&quot;) f2 &lt;- read_excel(&quot;data/merged_monitoring.xlsx&quot;) f2 &lt;- f2 %&gt;% dplyr::select(1,7,private,filial) f2$id = as.numeric(as.character(f2$id)) f12 &lt;- left_join(f1,f2, by = c(&quot;id_mon&quot; = &quot;id&quot;)) f12 &lt;- f12 %&gt;% dplyr::select(1,2,7,8) d &lt;- f12 %&gt;% group_by(private) %&gt;% count() knitr::kable(d, booktabs = T) %&gt;% kable_styling(bootstrap_options = &quot;striped&quot;, full_width = F) private n 0 502 1 320 Пропорция странная, неужели в России из 822 вузов 320 - частные (39 %). Смэтчим этот датасет из мониторинга с нашими грантами. Т.е. у нас у каждого гранта (~ 7600 шт) стоит организация посмотрим какие из них есть в мониторинге, они и будут нашими вузами (гос + негос). Всё что не найдется в мониторине мы будем считать НЕ ВУЗАМИ. Туда попадут всё акционерные обзества, подразделения РАН, научные центры, и к сожалению филиалы вузов (если такие вообще были, я не уверена). После этих действий мы получаем Таблицу_11_б: Таблица 11 б. data_f &lt;- left_join(data1, f12, by = c(&quot;id&quot; = &quot;id_rince&quot;)) S &lt;- data_f %&gt;% group_by(private) %&gt;% count() sum_n &lt;- sum(S$n) S &lt;- S %&gt;% mutate(`%` = 100*n/sum_n) S$private[S$private == &quot;0&quot;] &lt;- &quot;государственный вуз&quot; S$private[S$private == &quot;1&quot;] &lt;- &quot;частный вуз&quot; S$private[is.na(S$private)] &lt;- &quot;не вуз&quot; colnames(S)[1] &lt;- &quot;тип организации&quot; colnames(S)[2] &lt;- &quot;кол-во грантов&quot; options(digits = 1) knitr::kable(S, booktabs = T) %&gt;% kable_styling(bootstrap_options = &quot;striped&quot;, full_width = F) тип организации кол-во грантов % государственный вуз 3244 43 частный вуз 72 1 не вуз 4261 56 Вузы за 2014-2019 получили 44 % грантов РНФ. Причем частные вузы получили только 1 % всех грантов. Составим рейтинги организаций этих трех типов. У нас Иннополлис и Институт программных систем попали не туда, поправим их. data_f &lt;- data_f %&gt;% dplyr::mutate(private = case_when(id == &quot;14346&quot; ~ 1, id == &quot;668&quot; ~ NA_real_, TRUE ~ private)) Таблица 11 в. Гос вузы и их гранты g &lt;- data_f %&gt;% dplyr::filter(private == 0) %&gt;% group_by(Univ) %&gt;% count() g &lt;- formattable(g) g &lt;- g %&gt;% arrange(desc(n)) colnames(g)[1] &lt;- &quot;Гос вузы&quot; as.datatable(g) 192 гос универа получили 3244 гранта (43 % от всех грантов РНФ). Таблица 11 г. Частные вузы и их гранты g &lt;- data_f %&gt;% dplyr::filter(private == 1) %&gt;% group_by(Univ) %&gt;% count() g &lt;- formattable(g) g &lt;- g %&gt;% arrange(desc(n)) colnames(g)[1] &lt;- &quot;Частные вузы&quot; as.datatable(g) 11 частных универа получили 72 гранта (1 % от всех грантов РНФ). Таблица 11 д. НЕ ВУЗЫ и их гранты g &lt;- data_f %&gt;% dplyr::filter(is.na(private)) %&gt;% group_by(Univ) %&gt;% count() g &lt;- formattable(g) g &lt;- g %&gt;% arrange(desc(n)) colnames(g)[1] &lt;- &quot;НЕ вузы&quot; as.datatable(g) 404 НЕ вуза получили 4261 гранта (56 % от всех грантов РНФ). Вернемся к обнареженной странноти: у нас в мониторинге вузов (по сути это наша генеральная совокупность ) часных вузов - 39 %. Давайте посмортрим какой процент часных вузов среди нашиз вузов-грантополучателей. g &lt;- data_f %&gt;% dplyr::filter(!is.na(private)) %&gt;% group_by(Univ, private) %&gt;% count() %&gt;% group_by(private) %&gt;% count() sum_n &lt;- sum(g$n) g &lt;- g %&gt;% mutate(`%` = 100*n/sum_n) colnames(g)[2] &lt;- &quot;вузы (шт)&quot; knitr::kable(g, booktabs = T) %&gt;% kable_styling(bootstrap_options = &quot;striped&quot;, full_width = F) private вузы (шт) % 0 192 95 1 11 5 Получили только 5 %. То есть у нас следующая странность. Из всех вузов, существующих в России, у нас 39 % - частные. Из всех вузов, которые хоть раз получали грант РНФ, у нас 5 % - частные. 3. По областям фиксируют квоты? У нас есть 14 грантов у которых нет кода области, уберем их. Остается 7596 гратнов за 2014-2019 гг. Посмотрим по годам и областям знания: Таблица 12. quots &lt;- df3 %&gt;% dplyr::filter(!is.na(area)) %&gt;% dplyr::filter(area != &#39;NA&#39;) %&gt;% group_by(Год, area) %&gt;% count() library(tidyr) ar_ye &lt;- spread(quots, key = Год, value = n) knitr::kable(ar_ye , booktabs = T) %&gt;% kable_styling(bootstrap_options = &quot;striped&quot;, full_width = F) area 2014 2015 2016 2017 2018 2019 01 88 32 71 168 130 183 02 144 49 124 247 211 295 03 156 72 110 281 270 375 04 184 38 108 202 154 269 05 160 49 119 174 135 189 06 25 7 54 43 31 76 07 94 30 75 130 93 151 08 107 46 84 132 121 190 09 146 95 148 261 302 368 Это были гранты в штуках. Ничего непонятно. Пересчитаем в долях от общего числа выданных грантов в соответствующем году. Таблица 13. #ar_ye2 &lt;- spread(quots, key = area, value = n) sum2014 &lt;- sum(ar_ye$`2014`) sum2015 &lt;- sum(ar_ye$`2015`) sum2016 &lt;- sum(ar_ye$`2016`) sum2017 &lt;- sum(ar_ye$`2017`) sum2018 &lt;- sum(ar_ye$`2018`) sum2019 &lt;- sum(ar_ye$`2019`) ar_ye2 &lt;- ar_ye %&gt;% mutate(sh_2014 = `2014`/sum2014*100) %&gt;% mutate(sh_2015 = `2015`/sum2015*100) %&gt;% mutate(sh_2016 = `2016`/sum2016*100) %&gt;% mutate(sh_2017 = `2017`/sum2017*100) %&gt;% mutate(sh_2018 = `2018`/sum2018*100) %&gt;% mutate(sh_2019 = `2019`/sum2019*100) %&gt;% dplyr::select(1, starts_with(&quot;sh_&quot;)) options(digits = 2) ar_ye2 &lt;- formattable(ar_ye2) as.datatable(ar_ye2) Т.е. в 2014 году по направлениб 01 - Математика дали 8 % от всех выданных за тот год грантов. Визуализируем эту табличку. ar_ye3 &lt;- gather(ar_ye2, condition, measurement, sh_2014:sh_2019, factor_key=TRUE) ar_ye3 &lt;- ar_ye3 %&gt;% mutate(condition = gsub(&quot;[^0-9.-]+&quot;, &quot;&quot;, condition)) ar_ye3$condition = as.numeric(as.character(ar_ye3$condition)) ar_ye4 &lt;- ar_ye3 ar_ye3$area[ar_ye3$area == &quot;01&quot;] &lt;- &quot;01 - математика&quot; ar_ye3$area[ar_ye3$area == &quot;02&quot;] &lt;- &quot;02 - физика&quot; ar_ye3$area[ar_ye3$area == &quot;03&quot;] &lt;- &quot;03 - химия&quot; ar_ye3$area[ar_ye3$area == &quot;04&quot;] &lt;- &quot;04 - биология&quot; ar_ye3$area[ar_ye3$area == &quot;05&quot;] &lt;- &quot;05 - медицина&quot; ar_ye3$area[ar_ye3$area == &quot;06&quot;] &lt;- &quot;06 - с/х&quot; ar_ye3$area[ar_ye3$area == &quot;07&quot;] &lt;- &quot;07 - науки о земле&quot; ar_ye3$area[ar_ye3$area == &quot;08&quot;] &lt;- &quot;08 - гум и соц&quot; ar_ye3$area[ar_ye3$area == &quot;09&quot;] &lt;- &quot;09 - инженерия&quot; ggplot(ar_ye3, aes(x = condition, y = measurement, fill = area)) + geom_area(position = position_fill()) + scale_y_continuous(labels = scales::percent) График 1. ar_ye3$area2 &lt;- factor(ar_ye3$area, levels = c(&#39;06 - с/х&#39;, &#39;07 - науки о земле&#39;, &#39;01 - математика&#39;, &#39;05 - медицина&#39;, &#39;08 - гум и соц&#39;, &#39;04 - биология&#39;, &#39;02 - физика&#39;, &#39;09 - инженерия&#39;, &#39;03 - химия&#39;)) ggplot(ar_ye3, aes(x = condition, y = measurement, fill = area2)) + geom_area(position = position_fill(), linetype = 1, size =1 ,colour=&quot;black&quot; ) + scale_y_continuous(labels = scales::percent) + labs(y= &quot;% от всех грантов&quot;, x = &quot;год&quot;) Слои дают примерное представление о пропорции, но динамика видна не очень, посмотрим на аномальные скачки (если такие имеются) на другом типе графиков. График 2. ggplot(ar_ye3) + geom_line(aes(x = condition, y = measurement, colour = area)) +facet_wrap(~ area) + scale_x_continuous(breaks = c(2015,2017,2019)) + theme(axis.text.x = element_text(size = 8)) + labs(y= &quot;% от всех грантов&quot;, x = &quot;год&quot;) Надо подумать что мы видим, но самое главное не забывать проверять на заначимость. # ПОДВАЛ #поиск ненайденных 52 штук #library(readr) #df52 &lt;- read_delim(&quot;data/unknownKnown/топ ненайденых универов-Tаблица 1.csv&quot;, # &quot;;&quot;, escape_double = FALSE, trim_ws = TRUE) #df52 &lt;- df52 %&gt;% select(1,3) #colnames(df52)[2] &lt;- &quot;id&quot; #df52 &lt;- df52 %&gt;% filter(id &gt; 0) #joined_final &lt;- read_csv(&quot;data/joined_final.csv&quot;) #full_final_joined &lt;- left_join(joined_final, df52, by = &quot;Univ&quot;) #write.csv(full_final_joined, &quot;full_final_joined.csv&quot;, fileEncoding = &quot;UTF-8&quot;) #full_final_joined &lt;- full_final_joined %&gt;% select(-1,-2,-3,-12,-13) #dt &lt;- left_join(full_final_joined, universities_full_and_russian_universities, by = &quot;id&quot;) #d1 &lt;- d1 %&gt;% group_by(Univ) %&gt;% count() #d2 &lt;- dt %&gt;% filter(is.na(page)) %&gt;% group_by(Univ) %&gt;% count() #dt &lt;- dt %&gt;% filter(!is.na(page)) #write.csv(dt, &quot;full_11_May_version.csv&quot;, fileEncoding = &quot;UTF-8&quot;) #library(readr) #joined_final &lt;- read_csv(&quot;data/joined_final.csv&quot;) #joined_final_clean &lt;- read_csv(&quot;data/joined_final_clean.csv&quot;) #unknown &lt;- joined_final %&gt;% filter(is.na(id)) %&gt;% group_by(Univ) %&gt;% count() #unknown2 &lt;- joined_final %&gt;% filter(is.na(id)) #write.csv(unknown, &quot;unknown.csv&quot;, fileEncoding = &quot;UTF-8&quot;) #write.csv(unknown2, &quot;unknown2.csv&quot;, fileEncoding = &quot;UTF-8&quot;) "]
]
